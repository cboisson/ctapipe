

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Imaging (image) &mdash; ctapipe v0.3.4.post6+git43a2e83</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="ctapipe v0.3.4.post6+git43a2e83" href="../index.html"/>
        <link rel="next" title="chi_squared" href="../api/ctapipe.image.chi_squared.html"/>
        <link rel="prev" title="Flow-based framework (flow)" href="../flow/index.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> ctapipe
          

          
          </a>

          
            
            
              <div class="version">
                0.3.4.post6+git43a2e83
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting_started/index.html">Getting Started For Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/index.html">Development Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools/index.html">Command line tools (<code class="docutils literal"><span class="pre">tools</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysis/index.html">Analysis (<code class="docutils literal"><span class="pre">analysis</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../calib/index.html">Calibration (<code class="docutils literal"><span class="pre">calib</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../coordinates/index.html">Coordinates (<code class="docutils literal"><span class="pre">coordinates</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core/index.html">Core Structures and Base Classes (<code class="docutils literal"><span class="pre">core</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../datasets/index.html">Datasets (<code class="docutils literal"><span class="pre">datasets</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../flow/index.html">Flow-based framework (<code class="docutils literal"><span class="pre">flow</span></code>)</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Imaging (<code class="docutils literal"><span class="pre">image</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-ctapipe.image">ctapipe.image Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#classes">Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-ctapipe.image.toymodel">ctapipe.image.toymodel Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id1">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#toymodel-example">Toymodel Example</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-ctapipe.image.hillas">ctapipe.image.hillas Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#todo">TODO:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#change-log">CHANGE LOG:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id2">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id3">Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-ctapipe.image.cleaning">ctapipe.image.cleaning Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id4">Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-ctapipe.image.pixel_likelihood">ctapipe.image.pixel_likelihood Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id5">TODO:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id6">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id7">Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id8">Class Inheritance Diagram</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../instrument/index.html">Instrument (<code class="docutils literal"><span class="pre">instrument</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../io/index.html">Input/Output (<code class="docutils literal"><span class="pre">io</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reco/index.html">Reconstruction (<code class="docutils literal"><span class="pre">reco</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utils/index.html">Utilities (<code class="docutils literal"><span class="pre">utils</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../visualization/index.html">Visualization (<code class="docutils literal"><span class="pre">visualization</span></code>)</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">ctapipe</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
    <li>Imaging (<code class="docutils literal"><span class="pre">image</span></code>)</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/image/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="imaging-image">
<span id="image"></span><h1>Imaging (<code class="xref py py-obj docutils literal"><span class="pre">image</span></code>)<a class="headerlink" href="#imaging-image" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="#module-ctapipe.image" title="ctapipe.image"><code class="xref py py-obj docutils literal"><span class="pre">ctapipe.image</span></code></a> contains all algortihms that operate on Cherenkov camera images.</p>
<p>A <em>Cherenkov image</em> is defined as two pieces of data:</p>
<ul class="simple">
<li>a <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/index.html#module-numpy" title="(in NumPy v1.12)"><code class="xref py py-obj docutils literal"><span class="pre">numpy</span></code></a> array of pixel values (which can either be 1D, or 2D if time samples are included)</li>
<li>a description of the Camera geometry (pixel positions, etc), usually a <code class="xref py py-obj docutils literal"><span class="pre">io.CameraGeometry</span></code> object</li>
</ul>
<p>This module contains the following sub-modules:</p>
<ul class="simple">
<li><a class="reference internal" href="#module-ctapipe.image.cleaning" title="ctapipe.image.cleaning"><code class="xref py py-obj docutils literal"><span class="pre">cleaning</span></code></a> : image noise suppression</li>
<li><a class="reference internal" href="#module-ctapipe.image.hillas" title="ctapipe.image.hillas"><code class="xref py py-obj docutils literal"><span class="pre">hillas</span></code></a>: image moment parameterization</li>
<li><a class="reference internal" href="#module-ctapipe.image.toymodel" title="ctapipe.image.toymodel"><code class="xref py py-obj docutils literal"><span class="pre">toymodel</span></code></a>: fake shower image generation for testing purposes</li>
<li><a class="reference internal" href="#module-ctapipe.image.pixel_likelihood" title="ctapipe.image.pixel_likelihood"><code class="xref py py-obj docutils literal"><span class="pre">pixel_likelihood</span></code></a>: generates the likelihood of a pixel intensity, given an expectation value</li>
</ul>
</div>
<div class="section" id="reference-api">
<h2>Reference/API<a class="headerlink" href="#reference-api" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-ctapipe.image">
<span id="ctapipe-image-package"></span><h3>ctapipe.image Package<a class="headerlink" href="#module-ctapipe.image" title="Permalink to this headline">¶</a></h3>
<div class="section" id="functions">
<h4>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h4>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="../api/ctapipe.image.chi_squared.html#ctapipe.image.chi_squared" title="ctapipe.image.chi_squared"><code class="xref py py-obj docutils literal"><span class="pre">chi_squared</span></code></a>(image,&nbsp;prediction,&nbsp;ped[,&nbsp;...])</td>
<td>Simple chi-squared statistic from Le Bohec et al 2008</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../api/ctapipe.image.dilate.html#ctapipe.image.dilate" title="ctapipe.image.dilate"><code class="xref py py-obj docutils literal"><span class="pre">dilate</span></code></a>(geom,&nbsp;mask)</td>
<td>Add one row of neighbors to the True values of a pixel mask.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../api/ctapipe.image.hillas_parameters.html#ctapipe.image.hillas_parameters" title="ctapipe.image.hillas_parameters"><code class="xref py py-obj docutils literal"><span class="pre">hillas_parameters</span></code></a>(pix_x,&nbsp;pix_y,&nbsp;image[,&nbsp;...])</td>
<td>Compute Hillas parameters for a given shower image.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../api/ctapipe.image.hillas_parameters_1.html#ctapipe.image.hillas_parameters_1" title="ctapipe.image.hillas_parameters_1"><code class="xref py py-obj docutils literal"><span class="pre">hillas_parameters_1</span></code></a>(pix_x,&nbsp;pix_y,&nbsp;image[,&nbsp;...])</td>
<td>Compute Hillas parameters for a given shower image.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../api/ctapipe.image.hillas_parameters_2.html#ctapipe.image.hillas_parameters_2" title="ctapipe.image.hillas_parameters_2"><code class="xref py py-obj docutils literal"><span class="pre">hillas_parameters_2</span></code></a>(pix_x,&nbsp;pix_y,&nbsp;image[,&nbsp;...])</td>
<td>Compute Hillas parameters for a given shower image.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../api/ctapipe.image.hillas_parameters_3.html#ctapipe.image.hillas_parameters_3" title="ctapipe.image.hillas_parameters_3"><code class="xref py py-obj docutils literal"><span class="pre">hillas_parameters_3</span></code></a>(pix_x,&nbsp;pix_y,&nbsp;image[,&nbsp;...])</td>
<td>Compute Hillas parameters for a given shower image.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../api/ctapipe.image.hillas_parameters_4.html#ctapipe.image.hillas_parameters_4" title="ctapipe.image.hillas_parameters_4"><code class="xref py py-obj docutils literal"><span class="pre">hillas_parameters_4</span></code></a>(pix_x,&nbsp;pix_y,&nbsp;image[,&nbsp;...])</td>
<td>Compute Hillas parameters for a given shower image.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../api/ctapipe.image.mean_poisson_likelihood_full.html#ctapipe.image.mean_poisson_likelihood_full" title="ctapipe.image.mean_poisson_likelihood_full"><code class="xref py py-obj docutils literal"><span class="pre">mean_poisson_likelihood_full</span></code></a>(prediction,&nbsp;...)</td>
<td>Calculation of the mean  likelihood for a give expectation value of pixel intensity using the full numerical integration.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../api/ctapipe.image.mean_poisson_likelihood_gaussian.html#ctapipe.image.mean_poisson_likelihood_gaussian" title="ctapipe.image.mean_poisson_likelihood_gaussian"><code class="xref py py-obj docutils literal"><span class="pre">mean_poisson_likelihood_gaussian</span></code></a>(prediction,&nbsp;...)</td>
<td>Calculation of the mean  likelihood for a give expectation value of pixel intensity in the gaussian approximation.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../api/ctapipe.image.poisson_likelihood.html#ctapipe.image.poisson_likelihood" title="ctapipe.image.poisson_likelihood"><code class="xref py py-obj docutils literal"><span class="pre">poisson_likelihood</span></code></a>(image,&nbsp;prediction,&nbsp;...[,&nbsp;...])</td>
<td>Safe implementation of the poissonian likelihood implementation , adaptively switches between the full solution and the gaussian approx depending on the signal.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../api/ctapipe.image.poisson_likelihood_full.html#ctapipe.image.poisson_likelihood_full" title="ctapipe.image.poisson_likelihood_full"><code class="xref py py-obj docutils literal"><span class="pre">poisson_likelihood_full</span></code></a>(image,&nbsp;prediction,&nbsp;...)</td>
<td>Calculate likelihood of prediction given the measured signal, full numerical integration from de Naurois et al 2009.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../api/ctapipe.image.poisson_likelihood_gaussian.html#ctapipe.image.poisson_likelihood_gaussian" title="ctapipe.image.poisson_likelihood_gaussian"><code class="xref py py-obj docutils literal"><span class="pre">poisson_likelihood_gaussian</span></code></a>(image,&nbsp;...)</td>
<td>Calculate likelihood of prediction given the measured signal, gaussian approx from</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../api/ctapipe.image.tailcuts_clean.html#ctapipe.image.tailcuts_clean" title="ctapipe.image.tailcuts_clean"><code class="xref py py-obj docutils literal"><span class="pre">tailcuts_clean</span></code></a>(geom,&nbsp;image,&nbsp;pedvars[,&nbsp;...])</td>
<td>Clean an image by selection pixels that pass a two-threshold tail-cuts procedure.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="classes">
<h4>Classes<a class="headerlink" href="#classes" title="Permalink to this headline">¶</a></h4>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="../api/ctapipe.image.HillasParameterizationError.html#ctapipe.image.HillasParameterizationError" title="ctapipe.image.HillasParameterizationError"><code class="xref py py-obj docutils literal"><span class="pre">HillasParameterizationError</span></code></a></td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../api/ctapipe.image.MomentParameters.html#ctapipe.image.MomentParameters" title="ctapipe.image.MomentParameters"><code class="xref py py-obj docutils literal"><span class="pre">MomentParameters</span></code></a>(size,&nbsp;cen_x,&nbsp;cen_y,&nbsp;length,&nbsp;...)</td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../api/ctapipe.image.PixelLikelihoodError.html#ctapipe.image.PixelLikelihoodError" title="ctapipe.image.PixelLikelihoodError"><code class="xref py py-obj docutils literal"><span class="pre">PixelLikelihoodError</span></code></a></td>
<td></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="module-ctapipe.image.toymodel">
<span id="ctapipe-image-toymodel-module"></span><h3>ctapipe.image.toymodel Module<a class="headerlink" href="#module-ctapipe.image.toymodel" title="Permalink to this headline">¶</a></h3>
<p>Utilities to generate toymodel (fake) reconstruction inputs for testing purposes.</p>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ctapipe.io</span> <span class="kn">import</span> <span class="n">camera</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">geom</span> <span class="o">=</span> <span class="n">camera</span><span class="o">.</span><span class="n">make_rectangular_camera_geometry</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">showermodel</span> <span class="o">=</span> <span class="n">generate_2d_shower_model</span><span class="p">(</span><span class="n">centroid</span><span class="o">=</span><span class="p">[</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="n">length</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span> <span class="n">psi</span><span class="o">=</span><span class="s1">&#39;40d&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span><span class="p">,</span> <span class="n">signal</span><span class="p">,</span> <span class="n">noise</span> <span class="o">=</span> <span class="n">make_toymodel_shower_image</span><span class="p">(</span><span class="n">geom</span><span class="p">,</span> <span class="n">showermodel</span><span class="o">.</span><span class="n">pdf</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(400,)</span>
</pre></div>
</div>
<div class="section" id="id1">
<h4>Functions<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="../api/ctapipe.image.toymodel.generate_2d_shower_model.html#ctapipe.image.toymodel.generate_2d_shower_model" title="ctapipe.image.toymodel.generate_2d_shower_model"><code class="xref py py-obj docutils literal"><span class="pre">generate_2d_shower_model</span></code></a>(centroid,&nbsp;width,&nbsp;...)</td>
<td>Create a statistical model (2D gaussian) for a shower image in a camera.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../api/ctapipe.image.toymodel.make_toymodel_shower_image.html#ctapipe.image.toymodel.make_toymodel_shower_image" title="ctapipe.image.toymodel.make_toymodel_shower_image"><code class="xref py py-obj docutils literal"><span class="pre">make_toymodel_shower_image</span></code></a>(geom,&nbsp;showerpdf)</td>
<td>Generates a pedestal-subtracted shower image from a statistical shower model (as generated by <code class="xref py py-obj docutils literal"><span class="pre">shower_model</span></code>).</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="toymodel-example">
<h4>Toymodel Example<a class="headerlink" href="#toymodel-example" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;Example how to make a toymodel shower image and plot it.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">ctapipe.io.camera</span> <span class="kn">import</span> <span class="n">make_rectangular_camera_geometry</span>
<span class="kn">from</span> <span class="nn">ctapipe.image.toymodel</span> <span class="kn">import</span> <span class="n">generate_2d_shower_model</span><span class="p">,</span> <span class="n">make_toymodel_shower_image</span>

<span class="n">NX</span> <span class="o">=</span> <span class="mi">40</span>
<span class="n">NY</span> <span class="o">=</span> <span class="mi">40</span>

<span class="n">geom</span> <span class="o">=</span> <span class="n">make_rectangular_camera_geometry</span><span class="p">(</span><span class="n">NX</span><span class="p">,</span> <span class="n">NY</span><span class="p">)</span>

<span class="n">showermodel</span> <span class="o">=</span> <span class="n">generate_2d_shower_model</span><span class="p">(</span><span class="n">centroid</span><span class="o">=</span><span class="p">[</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="n">length</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
                                       <span class="n">width</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span> <span class="n">psi</span><span class="o">=</span><span class="s1">&#39;40d&#39;</span><span class="p">)</span>

<span class="n">image</span><span class="p">,</span> <span class="n">signal</span><span class="p">,</span> <span class="n">noise</span> <span class="o">=</span> <span class="n">make_toymodel_shower_image</span><span class="p">(</span><span class="n">geom</span><span class="p">,</span> <span class="n">showermodel</span><span class="o">.</span><span class="n">pdf</span><span class="p">,</span>
                                                  <span class="n">intensity</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">nsb_level_pe</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>

<span class="c1"># make them into 2D arrays so we can plot them with imshow</span>
<span class="n">image</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">NX</span><span class="p">,</span> <span class="n">NY</span><span class="p">)</span>
<span class="n">signal</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">NX</span><span class="p">,</span> <span class="n">NY</span><span class="p">)</span>
<span class="n">noise</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">NX</span><span class="p">,</span> <span class="n">NY</span><span class="p">)</span>

<span class="c1"># here we just plot the images using imshow().  For a more general</span>
<span class="c1"># case, one should use a ctapipe.visualization.CameraDisplay</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Signal&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">noise</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Noise&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Image&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../image/image_example.py">Source code</a>, <a class="reference external" href="../image/image_example.png">png</a>, <a class="reference external" href="../image/image_example.hires.png">hires.png</a>, <a class="reference external" href="../image/image_example.pdf">pdf</a>)</p>
<div class="figure">
<img alt="../_images/image_example.png" src="../_images/image_example.png" />
</div>
</div>
</div>
<div class="section" id="module-ctapipe.image.hillas">
<span id="ctapipe-image-hillas-module"></span><h3>ctapipe.image.hillas Module<a class="headerlink" href="#module-ctapipe.image.hillas" title="Permalink to this headline">¶</a></h3>
<p>Hillas shower parametrization.</p>
<div class="section" id="todo">
<h4>TODO:<a class="headerlink" href="#todo" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><dl class="first docutils">
<dt>remove alpha calculation (which is only about (0,0)),</dt>
<dd>and make a get alpha function that does it from an arbitrary point given a pre-computed list of parameters
(has this alpha function been implemented?  V. easy, given centroid and psi, or miss and dist/r)
(logically, should also remove &quot;miss&quot;, which is relative to (0,0)</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>add function(s) to calculate asymmetry (or asymmetries?) including sign calculation</dt>
<dd>(for now, MP/Whipple asymmetry is positive for &quot;tail&quot; pointing away from (0,0))
(I have a wonderful way to to this, but this margin is too small to contain it)</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>psi of hillas_parameters_1 and 2 does not match. Mismatch in hillas_parameters_2 need to be resolved:</dt>
<dd>psi of hillas_parameters_1 has inconsistent sign.  hillas_parameters_2/3/4 better, since +ve for tail pointing away
Mismatch between hillas_parameters_1/2 fixed in previous version, shouldn't this TODO be removed?</dd>
</dl>
</li>
<li>Implement higher order hillas parameters in hillas_parameters_2: Done (MP)</li>
</ul>
</div>
<div class="section" id="change-log">
<h4>CHANGE LOG:<a class="headerlink" href="#change-log" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p class="first">MP: Speed comparison for an image in a 960 pixel camera for image created with &quot;mock&quot;:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">timeit</span> <span class="o">-</span><span class="n">n</span> <span class="mi">10000</span>
<span class="n">hillas_parameters_1</span><span class="p">(</span><span class="n">pix_x</span><span class="p">,</span> <span class="n">pix_y</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">higherMoments</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>                        <span class="n">best</span> <span class="n">of</span> <span class="mi">3</span><span class="p">:</span>     <span class="mi">598</span> <span class="n">µs</span> <span class="n">per</span> <span class="n">loop</span>
<span class="n">hillas_parameters_1</span><span class="p">(</span><span class="n">pix_x</span><span class="p">,</span> <span class="n">pix_y</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">higherMoments</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>                       <span class="n">best</span> <span class="n">of</span> <span class="mi">3</span><span class="p">:</span>     <span class="mi">391</span> <span class="n">µs</span> <span class="n">per</span> <span class="n">loop</span>

<span class="n">hillas_parameters_2</span><span class="p">(</span><span class="n">pix_x</span><span class="p">,</span> <span class="n">pix_y</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">higherMoments</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">recalculate_pixels</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>        <span class="n">best</span> <span class="n">of</span> <span class="mi">3</span><span class="p">:</span>     <span class="mi">210</span> <span class="n">µs</span> <span class="n">per</span> <span class="n">loop</span>
<span class="n">hillas_parameters_2</span><span class="p">(</span><span class="n">pix_x</span><span class="p">,</span> <span class="n">pix_y</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">higherMoments</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">recalculate_pixels</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>       <span class="n">best</span> <span class="n">of</span> <span class="mi">3</span><span class="p">:</span>     <span class="mi">137</span> <span class="n">µs</span> <span class="n">per</span> <span class="n">loop</span>
<span class="n">hillas_parameters_2</span><span class="p">(</span><span class="n">pix_x</span><span class="p">,</span> <span class="n">pix_y</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">higherMoments</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">recalculate_pixels</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>       <span class="n">best</span> <span class="n">of</span> <span class="mi">3</span><span class="p">:</span>     <span class="mi">125</span> <span class="n">µs</span> <span class="n">per</span> <span class="n">loop</span>
<span class="n">hillas_parameters_2</span><span class="p">(</span><span class="n">pix_x</span><span class="p">,</span> <span class="n">pix_y</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">higherMoments</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">recalculate_pixels</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>      <span class="n">best</span> <span class="n">of</span> <span class="mi">3</span><span class="p">:</span>      <span class="mf">95.9</span> <span class="n">µs</span> <span class="n">per</span> <span class="n">loop</span>

<span class="n">hillas_parameters_3</span><span class="p">(</span><span class="n">pix_x</span><span class="p">,</span> <span class="n">pix_y</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">higherMoments</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>                        <span class="n">best</span> <span class="n">of</span> <span class="mi">3</span><span class="p">:</span>   <span class="mf">1.55</span> <span class="n">ms</span> <span class="n">per</span> <span class="n">loop</span>
<span class="n">hillas_parameters_3</span><span class="p">(</span><span class="n">pix_x</span><span class="p">,</span> <span class="n">pix_y</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">higherMoments</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>                       <span class="n">best</span> <span class="n">of</span> <span class="mi">3</span><span class="p">:</span>   <span class="mf">1.5</span> <span class="n">ms</span> <span class="n">per</span> <span class="n">loop</span>

<span class="n">hillas_parameters_4</span><span class="p">(</span><span class="n">pix_x</span><span class="p">,</span> <span class="n">pix_y</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">higherMoments</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">recalculate_pixels</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>        <span class="n">best</span> <span class="n">of</span> <span class="mi">3</span><span class="p">:</span>     <span class="mi">130</span> <span class="n">µs</span> <span class="n">per</span> <span class="n">loop</span>
<span class="n">hillas_parameters_4</span><span class="p">(</span><span class="n">pix_x</span><span class="p">,</span> <span class="n">pix_y</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">higherMoments</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">recalculate_pixels</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>       <span class="n">best</span> <span class="n">of</span> <span class="mi">3</span><span class="p">:</span>     <span class="mi">110</span> <span class="n">µs</span> <span class="n">per</span> <span class="n">loop</span>
<span class="n">hillas_parameters_4</span><span class="p">(</span><span class="n">pix_x</span><span class="p">,</span> <span class="n">pix_y</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">higherMoments</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">recalculate_pixels</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>       <span class="n">best</span> <span class="n">of</span> <span class="mi">3</span><span class="p">:</span>      <span class="mf">70.4</span> <span class="n">µs</span> <span class="n">per</span> <span class="n">loop</span>
<span class="n">hillas_parameters_4</span><span class="p">(</span><span class="n">pix_x</span><span class="p">,</span> <span class="n">pix_y</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">higherMoments</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">recalculate_pixels</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>      <span class="n">best</span> <span class="n">of</span> <span class="mi">3</span><span class="p">:</span>      <span class="mf">62.7</span> <span class="n">µs</span> <span class="n">per</span> <span class="n">loop</span>
</pre></div>
</div>
</li>
</ul>
<p>(any way to compare compiled versions?)</p>
<ul>
<li><p class="first">MP: all routines tested with +/- combinations and x/y swaps of &quot;mini-camera&quot;:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>    <span class="n">pix_x</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">pix_y</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>
    <span class="n">image</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span> <span class="p">])</span>


<span class="n">TODO</span><span class="p">:</span> <span class="n">add</span> <span class="n">this</span> <span class="k">as</span> <span class="n">a</span> <span class="n">test</span><span class="p">,</span> <span class="k">with</span> <span class="n">known</span> <span class="n">results</span> <span class="p">(</span><span class="n">change</span> <span class="n">sign</span> <span class="n">of</span> <span class="n">psi</span> <span class="n">where</span> <span class="n">needed</span><span class="p">):</span>
    <span class="p">(</span><span class="n">MomentParameters</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mf">37.0</span><span class="p">,</span> <span class="n">cen_x</span><span class="o">=</span><span class="mf">1.027027027027027</span><span class="p">,</span> <span class="n">cen_y</span><span class="o">=</span><span class="mf">3.4864864864864864</span><span class="p">,</span>
    <span class="n">length</span><span class="o">=</span><span class="mf">1.9951647036522218</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.028933760477638449</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mf">3.6346076177074274</span><span class="p">,</span>
    <span class="n">phi</span><span class="o">=</span><span class="mf">1.2843252459918457</span><span class="p">,</span> <span class="n">psi</span><span class="o">=</span><span class="mf">1.5876852050217887</span><span class="p">,</span> <span class="n">miss</span><span class="o">=</span><span class="mf">1.0857606054046072</span><span class="p">),</span>
    <span class="n">HighOrderMomentParameters</span><span class="p">(</span><span class="n">Skewness</span><span class="o">=</span><span class="mf">0.21338802620071526</span><span class="p">,</span> <span class="n">Kurtosis</span><span class="o">=</span><span class="mf">1.9087015993786907</span><span class="p">))</span>
</pre></div>
</div>
</li>
<li><dl class="first docutils">
<dt>MP: removed returning of asymmetry, just left skewness...</dt>
<dd><p class="first last">either MP/Whipple or MAGIC asymmetry can be calculated then in function</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>MP: added two Boolean variables to the call: higherMoments (default True) and recalculate_pixels (default True)</dt>
<dd><p class="first last">If higherMoments is False, then it doesn't calculate them (if True, calculated for those routines have them)
If recalculate_pixels is False, then the multiples of pixel positions are calculated always (if True, only if not existing)</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>MP: hillas_parameter_1 doesn't work for the case of horizontal image</dt>
<dd><p class="first last">It raises an exception wrongly; no reason to raise exception for S_xy = 0</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>MP: In hillas_parameter_1, it says delta/psi is angle with x-axis, but adds pi/2 (as does hillas_parameter_2).</dt>
<dd><dl class="first last docutils">
<dt>cos_delta and sin_delta are correct, though.</dt>
<dd><p class="first last">=&gt; changed this in hillas_parameter_1, and in modified the display visualization (in visualization/mpl.py)... and &quot;mock.py&quot; in reco.</p>
</dd>
</dl>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>MP: Added higher moments to hillas_parameters_2, and added a sub-function to hold static variables</dt>
<dd><p class="first last">of pixel multiplications, if pixel positions don't change</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>MP: Added Pythonified version of hillas_parameters_3, called hillal_parameters_4, also using</dt>
<dd><p class="first last">a sub-function's attributes to hold &quot;static variables&quot; of pixel multiplications, if pixel positions don't change</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>MP: Added the historic 1993 Whipple calculation (translated Fortran code via c), as hillas_parameters_3</dt>
<dd><p class="first last">Note, MAGIC's &quot;skewness&quot; is the same as the Whipple/MP &quot;asymmetry^3&quot;, why ???
... and also, Whipple/MP &quot;asymmetry&quot; * &quot;length&quot; = MAGIC &quot;asymmetry&quot;
... so, MAGIC &quot;asymmetry&quot; = MAGIC &quot;skewness&quot;^(1/3) * &quot;length&quot;
I don't know what MAGIC's &quot;asymmetry&quot; is supposed to be.</p>
</dd>
</dl>
</li>
<li><p class="first">MP: MAGIC (hillas_parameters_1) seems to be using the Whipple 1989 Weekes et al. formula calculation!
The Whipple 1993 Reynolds et al formula calculation is better (using non central or raw moments, not central moments).</p>
</li>
<li><dl class="first docutils">
<dt>Higher order moments need not be explicitly defined.</dt>
<dd><p class="first last">Only mean and size parameters are enough to define correlations of all order.
Implemented in the same way as in MAGIC.</p>
</dd>
</dl>
</li>
<li><p class="first">Third and fourth order correlations implemented in hillas_1.</p>
</li>
<li><p class="first">Sanity checks for size, x_y correlation
(HillasParameterizationError), length, width.</p>
</li>
<li><p class="first">Parameter psi introduced in hillas_parameters_1: angle between
ellipse major axis and camera x-axis.</p>
</li>
<li><dl class="first docutils">
<dt>Correction in implementation of miss parameter of hillas_parameters_1.</dt>
<dd><p class="first last">Previous implementation missed a square root factor.</p>
</dd>
</dl>
</li>
<li><p class="first">Correction in implementation of length, width in
hillas_parameters_2. Previous version missed a 2 in the denominator.</p>
</li>
<li><p class="first">Implementation of Higher Order Moment Parameters in
hillas_parameters_1: Skewness, Kurtosis.</p>
</li>
<li><p class="first">Implementation of Asymmetry. Alternative definition of asym using
higher order correlations mentioned in comments below asym.</p>
</li>
</ul>
</div>
<div class="section" id="id2">
<h4>Functions<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h4>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="../api/ctapipe.image.hillas.hillas_parameters.html#ctapipe.image.hillas.hillas_parameters" title="ctapipe.image.hillas.hillas_parameters"><code class="xref py py-obj docutils literal"><span class="pre">hillas_parameters</span></code></a>(pix_x,&nbsp;pix_y,&nbsp;image[,&nbsp;...])</td>
<td>Compute Hillas parameters for a given shower image.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../api/ctapipe.image.hillas.hillas_parameters_1.html#ctapipe.image.hillas.hillas_parameters_1" title="ctapipe.image.hillas.hillas_parameters_1"><code class="xref py py-obj docutils literal"><span class="pre">hillas_parameters_1</span></code></a>(pix_x,&nbsp;pix_y,&nbsp;image[,&nbsp;...])</td>
<td>Compute Hillas parameters for a given shower image.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../api/ctapipe.image.hillas.hillas_parameters_2.html#ctapipe.image.hillas.hillas_parameters_2" title="ctapipe.image.hillas.hillas_parameters_2"><code class="xref py py-obj docutils literal"><span class="pre">hillas_parameters_2</span></code></a>(pix_x,&nbsp;pix_y,&nbsp;image[,&nbsp;...])</td>
<td>Compute Hillas parameters for a given shower image.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../api/ctapipe.image.hillas.hillas_parameters_3.html#ctapipe.image.hillas.hillas_parameters_3" title="ctapipe.image.hillas.hillas_parameters_3"><code class="xref py py-obj docutils literal"><span class="pre">hillas_parameters_3</span></code></a>(pix_x,&nbsp;pix_y,&nbsp;image[,&nbsp;...])</td>
<td>Compute Hillas parameters for a given shower image.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../api/ctapipe.image.hillas.hillas_parameters_4.html#ctapipe.image.hillas.hillas_parameters_4" title="ctapipe.image.hillas.hillas_parameters_4"><code class="xref py py-obj docutils literal"><span class="pre">hillas_parameters_4</span></code></a>(pix_x,&nbsp;pix_y,&nbsp;image[,&nbsp;...])</td>
<td>Compute Hillas parameters for a given shower image.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id3">
<h4>Classes<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h4>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="../api/ctapipe.image.hillas.MomentParameters.html#ctapipe.image.hillas.MomentParameters" title="ctapipe.image.hillas.MomentParameters"><code class="xref py py-obj docutils literal"><span class="pre">MomentParameters</span></code></a>(size,&nbsp;cen_x,&nbsp;cen_y,&nbsp;length,&nbsp;...)</td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../api/ctapipe.image.hillas.HillasParameterizationError.html#ctapipe.image.hillas.HillasParameterizationError" title="ctapipe.image.hillas.HillasParameterizationError"><code class="xref py py-obj docutils literal"><span class="pre">HillasParameterizationError</span></code></a></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="class-inheritance-diagram">
<h4>Class Inheritance Diagram<a class="headerlink" href="#class-inheritance-diagram" title="Permalink to this headline">¶</a></h4>
<img src="../_images/inheritance-c8bd406fee75aaae561cb975639efe16439652ae.png" alt="Inheritance diagram of ctapipe.image.hillas.MomentParameters, ctapipe.image.hillas.HillasParameterizationError" usemap="#inheritance06a709c349" class="inheritance"/>
<map id="inheritance06a709c349" name="inheritance06a709c349">
<area shape="rect" id="node1" href="../api/ctapipe.image.hillas.HillasParameterizationError.html#ctapipe.image.hillas.HillasParameterizationError" target="_top" title="HillasParameterizationError" alt="" coords="5,55,191,80"/>
<area shape="rect" id="node2" href="../api/ctapipe.image.hillas.MomentParameters.html#ctapipe.image.hillas.MomentParameters" target="_top" title="MomentParameters(size, cen_x, cen_y, length, width, r, phi, psi, miss, skewness, kurtosis)" alt="" coords="29,5,167,31"/>
</map>
</div>
</div>
<div class="section" id="module-ctapipe.image.cleaning">
<span id="ctapipe-image-cleaning-module"></span><h3>ctapipe.image.cleaning Module<a class="headerlink" href="#module-ctapipe.image.cleaning" title="Permalink to this headline">¶</a></h3>
<p>Image Cleaning Algorithms (identification of noisy pixels)</p>
<div class="section" id="id4">
<h4>Functions<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h4>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="../api/ctapipe.image.cleaning.tailcuts_clean.html#ctapipe.image.cleaning.tailcuts_clean" title="ctapipe.image.cleaning.tailcuts_clean"><code class="xref py py-obj docutils literal"><span class="pre">tailcuts_clean</span></code></a>(geom,&nbsp;image,&nbsp;pedvars[,&nbsp;...])</td>
<td>Clean an image by selection pixels that pass a two-threshold tail-cuts procedure.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../api/ctapipe.image.cleaning.dilate.html#ctapipe.image.cleaning.dilate" title="ctapipe.image.cleaning.dilate"><code class="xref py py-obj docutils literal"><span class="pre">dilate</span></code></a>(geom,&nbsp;mask)</td>
<td>Add one row of neighbors to the True values of a pixel mask.</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="module-ctapipe.image.pixel_likelihood">
<span id="ctapipe-image-pixel-likelihood-module"></span><h3>ctapipe.image.pixel_likelihood Module<a class="headerlink" href="#module-ctapipe.image.pixel_likelihood" title="Permalink to this headline">¶</a></h3>
<p>Class for calculation of likelihood of a pixel expectation, given the pixel amplitude,
the level of noise in the pixel and the photoelectron resolution. This calculation is
taken from:
de Naurois &amp; Rolland, Astroparticle Physics, Volume 32, Issue 5, p. 231-252 (2009)
<a class="reference external" href="https://arxiv.org/abs/0907.2610">https://arxiv.org/abs/0907.2610</a></p>
<p>The likelihood is essentially a poissonian convolved with a gaussian, at low signal
a full possonian approach must be adopted, which requires the sum of contibutions
over a number of potential contributing photoelectrons (which is slow and can fail
at high signals due to the factorial which mst be calculated). At high signal this
simplifies to a gaussian approximation.</p>
<p>The full and gaussian approximations are implemented, in addition to a general purpose
implementation, which tries to intellegently switch between the two. Speed tests are below:</p>
<p>poisson_likelihood_gaussian(image, prediction, spe, ped)
29.8 µs per loop</p>
<p>poisson_likelihood_full(image, prediction, spe, ped)
93.4 µs per loop</p>
<p>poisson_likelihood(image, prediction, spe, ped)
59.9 µs per loop</p>
<div class="section" id="id5">
<h4>TODO:<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>Need to implement more tests, particularly checking for error states</li>
<li>Additional terms may be useful to add to the likelihood</li>
</ul>
</div>
<div class="section" id="id6">
<h4>Functions<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h4>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="../api/ctapipe.image.pixel_likelihood.poisson_likelihood_gaussian.html#ctapipe.image.pixel_likelihood.poisson_likelihood_gaussian" title="ctapipe.image.pixel_likelihood.poisson_likelihood_gaussian"><code class="xref py py-obj docutils literal"><span class="pre">poisson_likelihood_gaussian</span></code></a>(image,&nbsp;...)</td>
<td>Calculate likelihood of prediction given the measured signal, gaussian approx from</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../api/ctapipe.image.pixel_likelihood.poisson_likelihood_full.html#ctapipe.image.pixel_likelihood.poisson_likelihood_full" title="ctapipe.image.pixel_likelihood.poisson_likelihood_full"><code class="xref py py-obj docutils literal"><span class="pre">poisson_likelihood_full</span></code></a>(image,&nbsp;prediction,&nbsp;...)</td>
<td>Calculate likelihood of prediction given the measured signal, full numerical integration from de Naurois et al 2009.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../api/ctapipe.image.pixel_likelihood.poisson_likelihood.html#ctapipe.image.pixel_likelihood.poisson_likelihood" title="ctapipe.image.pixel_likelihood.poisson_likelihood"><code class="xref py py-obj docutils literal"><span class="pre">poisson_likelihood</span></code></a>(image,&nbsp;prediction,&nbsp;...[,&nbsp;...])</td>
<td>Safe implementation of the poissonian likelihood implementation , adaptively switches between the full solution and the gaussian approx depending on the signal.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../api/ctapipe.image.pixel_likelihood.mean_poisson_likelihood_gaussian.html#ctapipe.image.pixel_likelihood.mean_poisson_likelihood_gaussian" title="ctapipe.image.pixel_likelihood.mean_poisson_likelihood_gaussian"><code class="xref py py-obj docutils literal"><span class="pre">mean_poisson_likelihood_gaussian</span></code></a>(prediction,&nbsp;...)</td>
<td>Calculation of the mean  likelihood for a give expectation value of pixel intensity in the gaussian approximation.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../api/ctapipe.image.pixel_likelihood.mean_poisson_likelihood_full.html#ctapipe.image.pixel_likelihood.mean_poisson_likelihood_full" title="ctapipe.image.pixel_likelihood.mean_poisson_likelihood_full"><code class="xref py py-obj docutils literal"><span class="pre">mean_poisson_likelihood_full</span></code></a>(prediction,&nbsp;...)</td>
<td>Calculation of the mean  likelihood for a give expectation value of pixel intensity using the full numerical integration.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../api/ctapipe.image.pixel_likelihood.chi_squared.html#ctapipe.image.pixel_likelihood.chi_squared" title="ctapipe.image.pixel_likelihood.chi_squared"><code class="xref py py-obj docutils literal"><span class="pre">chi_squared</span></code></a>(image,&nbsp;prediction,&nbsp;ped[,&nbsp;...])</td>
<td>Simple chi-squared statistic from Le Bohec et al 2008</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id7">
<h4>Classes<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h4>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="../api/ctapipe.image.pixel_likelihood.PixelLikelihoodError.html#ctapipe.image.pixel_likelihood.PixelLikelihoodError" title="ctapipe.image.pixel_likelihood.PixelLikelihoodError"><code class="xref py py-obj docutils literal"><span class="pre">PixelLikelihoodError</span></code></a></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id8">
<h4>Class Inheritance Diagram<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h4>
<img src="../_images/inheritance-3fbb6b8af91154dff93d5b7d39921e581d29abd0.png" alt="Inheritance diagram of ctapipe.image.pixel_likelihood.PixelLikelihoodError" usemap="#inheritance06ec4ffbc4" class="inheritance"/>
<map id="inheritance06ec4ffbc4" name="inheritance06ec4ffbc4">
<area shape="rect" id="node1" href="../api/ctapipe.image.pixel_likelihood.PixelLikelihoodError.html#ctapipe.image.pixel_likelihood.PixelLikelihoodError" target="_top" title="PixelLikelihoodError" alt="" coords="5,5,145,31"/>
</map>
</div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../api/ctapipe.image.chi_squared.html" class="btn btn-neutral float-right" title="chi_squared" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../flow/index.html" class="btn btn-neutral" title="Flow-based framework (flow)" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright ctapipe developers.  Last updated 08 Feb 2017 12:44.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.3.4.post6+git43a2e83',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>